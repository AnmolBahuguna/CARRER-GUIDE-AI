{% extends "base.html" %}

{% block title %}Resume Builder - SmartCareer{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 py-12 px-4">
    <div class="max-w-6xl mx-auto">
        <div class="text-center mb-12" data-aos="fade-down">
            <h1 class="text-4xl font-bold text-gray-900 mb-4">Professional Resume Builder</h1>
            <p class="text-xl text-gray-600">Create a stunning resume in minutes</p>
        </div>
        
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Form -->
            <div class="bg-white rounded-lg shadow-lg p-8" data-aos="fade-right">
                <form id="resumeForm" class="space-y-6">
                    <!-- Personal Info -->
                    <div>
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Personal Information</h3>
                        <input type="text" id="name" placeholder="Full Name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-blue-600">
                        <input type="email" id="email" placeholder="Email" required class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-blue-600">
                        <input type="tel" id="phone" placeholder="Phone" required class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-blue-600">
                        <input type="text" id="location" placeholder="City, State" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600">
                    </div>
                    
                    <!-- Education -->
                    <div>
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Education</h3>
                        <input type="text" id="education" placeholder="Degree & Field (e.g., B.Tech Computer Science)" required class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-blue-600">
                        <input type="text" id="university" placeholder="University/College Name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-blue-600">
                        <input type="text" id="graduation_year" placeholder="Graduation Year" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600">
                    </div>
                    
                    <!-- Experience -->
                    <div>
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Work Experience</h3>
                        <input type="text" id="job_title" placeholder="Job Title" required class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-blue-600">
                        <input type="text" id="company" placeholder="Company Name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-blue-600">
                        <input type="text" id="employment_period" placeholder="Jan 2023 - Present" required class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-blue-600">
                        <textarea id="job_description" placeholder="Describe your responsibilities and achievements" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"></textarea>
                    </div>
                    
                    <!-- Skills -->
                    <div>
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Skills</h3>
                        <textarea id="skills" placeholder="Enter skills separated by commas (e.g., Python, JavaScript, React)" rows="3" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"></textarea>
                    </div>
                    
                    <!-- Projects -->
                    <div>
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Projects</h3>
                        <input type="text" id="project_name" placeholder="Project Name" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-blue-600">
                        <textarea id="project_description" placeholder="Project description and technologies used" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"></textarea>
                    </div>
                    
                    <!-- Summary -->
                    <div>
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Professional Summary</h3>
                        <textarea id="summary" placeholder="Write a brief professional summary (2-3 sentences)" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"></textarea>
                    </div>
                    
                    <button type="button" onclick="generateResume()" class="w-full px-6 py-3 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 transition">
                        Generate Resume
                    </button>
                </form>
            </div>
            
            <!-- Preview -->
            <div class="bg-white rounded-lg shadow-lg p-8 h-fit" data-aos="fade-left">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl font-bold text-gray-900">Resume Preview</h3>
                    <button onclick="downloadResume()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition text-sm font-semibold" style="display: none;" id="downloadBtn">
                        ⬇️ Download
                    </button>
                </div>
                <div id="resumePreview" class="border border-gray-300 p-6 rounded-lg bg-white text-gray-900 text-sm space-y-4">
                    <p class="text-gray-500 text-center">Fill in the form and click "Generate Resume" to see preview</p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
let generatedHTML = '';

async function generateResume() {
    const data = {
        name: document.getElementById('name').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        location: document.getElementById('location').value,
        education: document.getElementById('education').value,
        university: document.getElementById('university').value,
        graduation_year: document.getElementById('graduation_year').value,
        job_title: document.getElementById('job_title').value,
        company: document.getElementById('company').value,
        employment_period: document.getElementById('employment_period').value,
        job_description: document.getElementById('job_description').value,
        skills: document.getElementById('skills').value.split(',').map(s => s.trim()),
        project_name: document.getElementById('project_name').value,
        project_description: document.getElementById('project_description').value,
        summary: document.getElementById('summary').value
    };
    
    try {
        const response = await fetch('/api/build_resume', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(data)
        });
        
        if (response.ok) {
            const result = await response.json();
            generatedHTML = result.html;
            
            // Show preview
            const preview = document.getElementById('resumePreview');
            preview.innerHTML = `
                <h2 class="text-2xl font-bold text-center">${data.name}</h2>
                <p class="text-center text-gray-600">${data.email} | ${data.phone} | ${data.location}</p>
                <div class="border-t pt-4">
                    <h3 class="font-bold mb-2">Professional Summary</h3>
                    <p>${data.summary || 'Summary not provided'}</p>
                </div>
                <div class="border-t pt-4">
                    <h3 class="font-bold mb-2">Education</h3>
                    <p><strong>${data.education}</strong></p>
                    <p>${data.university} | ${data.graduation_year}</p>
                </div>
                <div class="border-t pt-4">
                    <h3 class="font-bold mb-2">Experience</h3>
                    <p><strong>${data.job_title}</strong> at ${data.company}</p>
                    <p class="text-sm text-gray-600">${data.employment_period}</p>
                    <p>${data.job_description}</p>
                </div>
                <div class="border-t pt-4">
                    <h3 class="font-bold mb-2">Skills</h3>
                    <p>${data.skills.join(', ')}</p>
                </div>
                ${data.project_name ? `
                <div class="border-t pt-4">
                    <h3 class="font-bold mb-2">Projects</h3>
                    <p><strong>${data.project_name}</strong></p>
                    <p>${data.project_description}</p>
                </div>
                ` : ''}
            `;
            
            document.getElementById('downloadBtn').style.display = 'block';
        }
    } catch (error) {
        alert('Error generating resume');
    }
}

function downloadResume() {
    if (!generatedHTML) {
        alert('Generate resume first');
        return;
    }
    
    const element = document.createElement('a');
    element.setAttribute('href', 'data:text/html;charset=utf-8,' + encodeURIComponent(generatedHTML));
    element.setAttribute('download', 'resume.html');
    element.style.display = 'none';
    document.body.appendChild(element);
    element.click();
    document.body.removeChild(element);
}
</script>
{% endblock %}
